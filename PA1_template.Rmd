---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

1. Code for reading in the dataset and/or processing the data

```r
actData <- read.csv("C:/temp/activity.csv", header=TRUE, sep=",")

actData$date <- as.Date(actData$date)
actData$steps <- as.numeric(actData$steps)
actData$interval <- as.numeric(actData$interval)
```

## What is mean total number of steps taken per day?

2. Histogram of the total number of steps taken each day

```r
actDataByMonth <- aggregate(actData$steps, by = list(actData$date),
                            FUN = sum, na.rm = TRUE)
names(actDataByMonth) <- c("date", "steps")
library(scales)
library(ggplot2)

ggplot(actDataByMonth, aes(x = date, y = steps)) + 
    geom_bar(stat = "identity", fill = "lightblue", color="black", binwidth = 2000) + 
    labs(title = "Total steps per day", x = "Date", y = "Number of Steps") +
    scale_x_date(breaks = date_breaks("1 week"),
                 labels = date_format("%d %b %y")) +
    geom_line(stat="hline", yintercept=mean, linetype="dotted") +
    geom_line(stat="hline", yintercept=median, linetype="dashed")
```

![plot of chunk plotsumperday](figure/plotsumperday.png) 

3. Mean and median number of steps taken each day

```r
mean(actDataByMonth$steps)
```

```
## [1] 9354
```

```r
median(actDataByMonth$steps)
```

```
## [1] 10395
```

## What is the average daily activity pattern?

4. Time series plot of the average number of steps taken

```r
actDataByInterval <- aggregate(actData$steps, by = list(actData$interval),
                                FUN = mean, na.rm = TRUE)

names(actDataByInterval) <- c("interval","steps")
```

Plot is created using the ggplot package

```r
ggplot(actDataByInterval, aes(x = interval, y = steps)) + 
    geom_line(color = "darkgreen") + 
    labs(title = "Average (mean) number of steps by Interval", x = "Interval", y = "Number of steps")
```

![plot of chunk plotmeanperinteval](figure/plotmeanperinteval.png) 

5. The 5-minute interval that, on average, contains the maximum number of steps

```r
maxSteps <- which.max(actDataByInterval$steps)
actDataByInterval[maxSteps, ]
```

```
##     interval steps
## 104      835 206.2
```

## Imputing missing values

6. Code to describe and show a strategy for imputing missing data

```r
missingValues <- which(is.na(actData$steps))
length(missingValues)
```

```
## [1] 2304
```

Dataset is populated with missing values using the mean

```r
actFullData <- actData
for(i in missingValues) {
    actFullData$steps[i] <- actDataByInterval[which(actDataByInterval$interval == actFullData[i, "interval"]), "steps"]
}
```

We new data number of steps per day is calculated


```r
actFullDataByMonth <- aggregate(actFullData$steps, by = list(actFullData$date),
                            FUN = sum, na.rm = TRUE)
names(actFullDataByMonth) <- c("date", "steps")
```

7. Histogram of the total number of steps taken each day after missing values are imputed

Histogram is created using the ggplot package

```r
ggplot(actFullDataByMonth, aes(x = date, y = steps)) + 
    geom_bar(stat = "identity", fill = "lightblue", color="black", binwidth = 2000) + 
    labs(title = "Total steps per day - Full Dataset", x = "Date", y = "Number of Steps") +
    scale_x_date(breaks = date_breaks("1 week"),
                 labels = date_format("%d %b %y")) +
    geom_line(stat="hline", yintercept=mean, linetype="dotted") +
    geom_line(stat="hline", yintercept=median, linetype="dashed")
```

![plot of chunk plotfullsumperday](figure/plotfullsumperday.png) 

8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends


```r
actFullData <- transform(actFullData, isWeekend=as.POSIXlt(date)$wday %in% c(0, 6))
actFullDataByIntervalDay <- aggregate(actFullData$steps,
                                      by = list(actFullData$interval, actFullData$isWeekend),
                                      FUN = mean)
names(actFullDataByIntervalDay) <- c("interval","isWeekend","steps")
library(lattice)
xyplot(steps ~ interval|isWeekend, data = actFullDataByIntervalDay,
       type = "l", layout=c(1, 2),
       main = "Average Steps by Interval and Weekend (TRUE) / Weekday(FALSE)",
       xlab = "Interval", ylab = "Average Steps (mean)")
```

![plot of chunk plotweekends](figure/plotweekends.png) 

9. All of the R code needed to reproduce the results (numbers, plots, etc.) in the report

All code, including output of numbers and plots, as been included in the above report.